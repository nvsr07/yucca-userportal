<div ng-controller="DataExplorerDetailCtrl as detailCtrl" ng-cloak>
	<div class='container'>
		<h3 class='entity-title'>
			<span translate>STREAM</span> <small>{{stream.codiceStream}} - {{stream.nomeStream}}</small>
		</h3>
		<div class='row'>
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<div class="alert alert-danger" ng-show='updateError'>
					<strong>{{updateError.error_message}}</strong>
					{{updateError.error_detail}}
				</div>
				<div class="alert alert-success" ng-show='updateInfo'>
					<strong><span translate>MANAGEMENT_VIEW_STREAM_LIFECYCLE_OK_INFO</span></strong> {{updateInfo.status}}
				</div>
			</div>
		</div>
		
		<div class='clearfix entity-info entity-info-top'>
			<div class='pull-left'>
				<div><small><span translate>STREAM_FIELD_NAME</span></small></div>
				<div class='main-info'><strong>{{stream.nomeStream}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>STREAM_FIELD_CREATION_DATE</span></small></div>
				<div><strong>{{stream.registrationDate}}</strong></div>
			
			</div>
		</div>
		<div class='clearfix entity-info entity-info-bottom'>
			<div class='pull-left'>
				<div><small><span translate>STREAM_FIELD_CODE</span></small></div>
				<div class='url'><strong>{{stream.codiceStream}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>STREAM_FIELD_VERSION</span></small></div>
				<div><strong>{{stream.deploymentVersion}}</strong></div>
			
			</div>
		</div>
		
		<accordion close-others="false">
			<accordion-group is-open="!status1.open">
				<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_STREAM_GENERAL_INFO</span>
		 			<i class="pull-right glyphicon hide" ng-class="{'glyphicon-minus': status1.open, 'glyphicon-plus': !status1.open}"></i>
				</accordion-heading>
				<div class='row'>
					<div class="col-sm-10">
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_DESCRIPTION</span></strong></div>
							<div class='col-sm-6'><span >{{stream.nomeStream}}</span></div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_DATADOMAIN</span>/<span translate>STREAM_FIELD_DOMAIN</span></strong></div>
							<div class='col-sm-6'><span >{{stream.domainStream|translate}}</span></div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_STATUS</span></strong></div>
							<div class='col-sm-10'>{{stream.deploymentStatusDesc|translate}}</div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TAGS</span></strong></div>
							<div class='col-sm-10'>
								<ul class="list-inline">
									<li ng-repeat="tag in stream.streamTags.tag">
										<span class="label label-tag label-custom"><span ng-bind-html="tag.tagCode|translate"></span></span>
									</li>
								</ul>
							</div>
						</div>
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span ng-bind-html="'STREAM_FIELD_VISIBILITY'|translate"></span></strong></div>
							<div class='col-sm-2'>{{stream.visibility}}</div>
							<div class='col-sm-2 text-right'card-label" ng-show="stream.visibility=='private'"><strong><span translate>DATASET_FIELD_TENANTSSHARED_WITH</span></strong></div>
							<div class='col-sm-6'>
								<span  ng-repeat="tenantSharing in stream.tenantssharing.tenantsharing">
									<span ng-show="tenantSharing.isOwner==0" >{{tenantSharing.tenantName}}</span>
								</span> &nbsp;
							</div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>MANAGEMENT_EDIT_STREAM_SAVE_DATA_LABEL</span></strong></div>
							<div class='col-sm-10'>{{stream.saveData|booleanToString|translate}}</div>
						</div>	
					</div>
					<div class="col-sm-2 text-right">
						<img ng-src="{{stream.streamIcon}}" alt="logo stream" class='upload-icon-preview-img' >
					</div>
				</div>
			</accordion-group>
			<accordion-group is-open="status2.open">
				<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_STREAM_LEGAL_INFO</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status2.open, 'glyphicon-plus': !status2.open}"></i>
				</accordion-heading>
	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_LICENCE</span></strong></div>
					<div class='col-sm-10'>{{stream.licence}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_DISCLAIMER</span></strong></div>
					<div class='col-sm-10'>{{stream.disclaimer}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_COPYRIGHT</span></strong></div>
					<div class='col-sm-10'>{{stream.copyright}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status3.open" ng-show="stream!=null">
				<accordion-heading>
					<span translate>VIRTUALENTITY</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status3.open, 'glyphicon-plus': !status3.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_NAME</span></strong></div>
					<div class='col-sm-10'>{{stream.virtualEntityName|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_CODE</span></strong></div>
					<div class='col-sm-10'>{{stream.codiceVirtualEntity|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_DESCRIPTION</span></strong></div>
					<div class='col-sm-10'>{{stream.virtualEntityDescription|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_TYPE</span></strong></div>
					<div class='col-sm-10'>{{stream.tipoVirtualEntity|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_CATEGORY</span></strong></div>
					<div class='col-sm-10'>{{stream.categoriaVirtualEntity|nvl:''}}</div>
				</div>	
				<div class="row card-row"  ng-show="stream.virtualEntityPositions.position!=null">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_POSITION</span></strong></div>
					<div class='col-sm-4'>[{{stream.virtualEntityPositions.position[0].lat}};{{stream.virtualEntityPositions.position[0].lon}}]</div>
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_ELEVATION</span></strong></div>
					<div class='col-sm-4'>{{stream.virtualEntityPositions.position.elevation[0]|nvl:' -'}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status4.open" ng-show="stream!=null">
				<accordion-heading>
					<span translate>STREAM</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status4.open, 'glyphicon-plus': !status4.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_NAME</span></strong></div>
					<div class='col-sm-10'>{{stream.nomeStream|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_CODE</span></strong></div>
					<div class='col-sm-10'>{{stream.codiceStream|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_FPS</span></strong></div>
					<div class='col-sm-10'>{{stream.fps|nvl:' -'}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status5.open"  ng-show="stream.idTipoVe != VIRTUALENTITY_TYPE_TWITTER_ID">
				<accordion-heading>
		 			<span translate>STREAM_FIELD_COMPONENTS</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status5.open, 'glyphicon-plus': !status5.open}"></i>
				</accordion-heading>
				<div class='card-label-separator'><span translate>STREAM_FIELD_COMPONENTS</span></div>
				<table class='table dashboard-table-components'  ng-show="stream.idTipoVE != VIRTUALENTITY_TYPE_TWITTER_ID">
					<thead>
						<tr>
							<th><span translate>STREAM_FIELD_COMPONENTS_NAME</span></th>
							<th><span ng-bind-html="'STREAM_FIELD_COMPONENTS_UNIT_OF_MEASUREMENT'|translate"></span></th>
							<th><span translate>STREAM_FIELD_COMPONENTS_TOLERANCE</span></th>
							<th><span translate>STREAM_FIELD_COMPONENTS_PHENOMENON</span></th>
							<th><span translate>STREAM_FIELD_COMPONENTS_SINCE_VERSION</span></th>
							<th><span translate>STREAM_FIELD_COMPONENTS_DATA_TYPE</span></th>
						</tr>	
					</thead>
					<tbody>
						<tr ng-repeat="component in stream.componenti.element">
							<td><span style="display: none"> {{component.idComponente}}</span>{{component.nome}}</td>
							<td>{{component.measureUnitCategory}}: {{component.measureUnit}}</td>
							<td>{{component.tolerance}}</td>
							<td>{{component.phenomenonCategory}}: {{component.phenomenon}}</td>
							<td>{{component.sinceVersion}}</td>
							<td>{{component.dataType}}</td>
						</tr>	
					</tbody>
				</table>
			</accordion-group>
			<accordion-group is-open="status6.open"  ng-show="stream.idTipoVe == VIRTUALENTITY_TYPE_TWITTER_ID">
				<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_STREAM_TWITTER_DATA</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status6.open, 'glyphicon-plus': !status6.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_QUERY</span></strong></div>
					<div class='col-sm-6'>{{stream.twtQuery}}</div>
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_LANG</span></strong></div>
					<div class='col-sm-2'>{{stream.twtLang}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>MANAGEMENT_NEW_STREAM_GEO_COORDINATES</span></strong></div>
					<div class='col-sm-6'><span ng-show="stream.twtGeolocLat!=0 || stream.twtGeolocLon!=0">{{stream.twtGeolocLat}},{{stream.twtGeolocLon}}</span></div>
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_GEO_RADIUS</span></strong></div>
					<div class='col-sm-2'><span ng-show="stream.twtGeolocRadius!=0">{{stream.twtGeolocRadius}} {{stream.twtUnit}}</span></div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_RATE</span></strong></div>
					<div class='col-sm-1'>{{twitterPollingInterval}}</span>
					</div>
					<div class="col-sm-9 ">
						<i><span translate class='' >MANAGEMENT_EDIT_STREAM_TWT_POLLING_HELP</span></i>
					</div>
					
				</div>	
			</accordion-group>
			<accordion-group is-open="status7.open">
				<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_STREAM_SETTINGS</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status4.open, 'glyphicon-plus': !status4.open}"></i>
				</accordion-heading>
				<div class='card-label-separator'><span translate>MANAGEMENT_EDIT_STREAM_SETTINGS</span></div>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span ng-bind-html="'STREAM_FIELD_VISIBILITY'|translate"></span></strong></div>
					<div class='col-sm-2'>{{stream.visibility}}</div>
					<div class='col-sm-2 text-right'card-label" ng-show="stream.visibility=='private'"><strong><span translate>STREAM_FIELD_TENANTSSHARED_WITH</span></strong></div>
					<div class='col-sm-6'>
						<span  ng-repeat="tenantSharing in stream.tenantssharing.tenantsharing">
							<span ng-show="tenantSharing.isOwner==0" >{{tenantSharing.tenantName}}</span>
						</span> &nbsp;
					</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>MANAGEMENT_EDIT_STREAM_PUBLISH_ON_STORE_LABEL</span></strong></div>
					<div class='col-sm-10'>{{stream.publishStream|booleanToString|translate}}</div>
				</div>	
			</accordion-group>
		</accordion>
		<div class="row card-toolbar">
			<a  href='#' class="btn  disabled btn-historical" title="{{'COMING_SOON'|translate}}">
				<span class="glyphicon glyphicon-time "></span> <span translate>MANAGEMENT_VIEW_STREAM_HISTORICAL_BUTTON</span>
			</a>
			<a  href='#' class="btn  btn-delete disabled" title="{{'COMING_SOON'|translate}}">
				<span class="glyphicon glyphicon-trash "></span> <span translate>MANAGEMENT_VIEW_STREAM_DELETE_BUTTON</span>
			</a>
			<a  href='#/dashboard/stream/{{tenantCode}}/{{stream.codiceVirtualEntity}}/{{stream.codiceStream}}' class="btn btn-default btn-edit"" title="{{'COMING_SOON'|translate}}">
				<span class="glyphicon glyphicon-equalizer "></span> <span translate>MANAGEMENT_VIEW_STREAM_DASHBOARD_BUTTON</span>
			</a>
			<a  href='#/management/editStream/{{tenantCode}}/{{stream.codiceVirtualEntity}}/{{stream.codiceStream}}' class="btn btn-default btn-edit" ng-show="isOwner() && canEdit() && isAuthorized('management/streams/update')">
				<span class="glyphicon glyphicon-pencil "></span> <span translate>MANAGEMENT_VIEW_STREAM_EDIT_BUTTON</span>
			</a>
			<a  href='javascript:void(0)' class="btn  btn-uninstall" ng-show="isOwner() && canUnistall() && isAuthorized('management/streams/req_disinst')" ng-click='requestUnistallation()'>
				<span class="glyphicon glyphicon-open "></span> <span translate>MANAGEMENT_VIEW_STREAM_UNINSTALL_BUTTON</span>
			</a>
			<a  href='javascript:void(0)' class="btn  btn-new" ng-show="isOwner() && canCreateNewVersion() && isAuthorized('management/streams/update')" ng-click='createNewVersion()'>
				<span class="glyphicon glyphicon-export "></span> <span translate>MANAGEMENT_VIEW_STREAM_NEWVERSION_BUTTON</span>
			</a>
			<a  href='javascript:void(0)' class="btn  btn-install" ng-show="isOwner() && canInstall() && isAuthorized('management/streams/req_inst')" ng-click='requestInstallation()'>
				<span class="glyphicon glyphicon-save "></span> <span translate>MANAGEMENT_VIEW_STREAM_INSTALL_BUTTON</span>
			</a>
		</div>
	</div>
</div>
