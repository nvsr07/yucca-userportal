<div ng-controller="ManagementDatasetListCtrl as datasetsCtrl"  ng-cloak>
	<div class='container'>
		<h3> <span translate-cloak translate>MANAGEMENT_DATASET_SUBTITLE </span></h3>
		<div class='row'>
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" >
				<div class='row  content-toolbar row-compact'>
					<div class="col-sm-4">
			        	<a href="#/management/newDataset/{{tenantCode}}" class="btn  btn-new" ng-disabled="!isAuthorized('management/datasets/update') ||!isOwner() ">
							<span class="glyphicon glyphicon-plus "></span>&nbsp;&nbsp;<span translate-cloak translate>MANAGEMENT_DATASET_LIST_NEW_DATASET</span>
						</a>
						<button  href  ng-click='editDataset()' class="btn  btn-edit" ng-disabled="!isAuthorized('management/datasets/update') || !isOwner() || !canEdit()" title="{{'MANAGEMENT_DATASET_LIST_EDIT_DATASET_BUTTON_HINT'|translate}}">
							<span class="glyphicon glyphicon-pencil "></span>&nbsp;&nbsp;<span translate-cloak translate>MANAGEMENT_DATASET_LIST_EDIT_DATASET</span>
						</button>
						<!--  <a href="#/management/importDatabase/{{tenantCode}}" class="btn  btn-new" ng-disabled="!isAuthorized('management/datasets/update') ||!isOwner() " title="{{'MANAGEMENT_DATASET_LIST_IMPORT_DB_BUTTON_HINT'|translate}}"> -->
						<a href="#/management/importDatabase/{{tenantCode}}" class="btn  btn-new" title="{{'MANAGEMENT_DATASET_LIST_IMPORT_DB_BUTTON_HINT'|translate}}">
							<span class="fa fa-database"></span>&nbsp;&nbsp;<span translate-cloak translate>MANAGEMENT_DATASET_LIST_IMPORT_DB</span>
						</a>
						<!-- 
						<button href="javascript:void(0)" ng-click='open()'class="btn  btn-delete" ng-disabled="!isAuthorized('management/datasets/update') || !isOwner() || !canDelete()" title="{{'MANAGEMENT_DATASET_LIST_DELETE_DATASET_BUTTON_HINT'|translate}}">
							<span class="glyphicon glyphicon-trash "></span>&nbsp;<span translate-cloak translate>MANAGEMENT_DATASET_LIST_DELETE_DATASET</span>
						</button>  -->
					</div>
					<div class="col-sm-8">
						<form class="form form-horizontal-compact management-filter-panel" role="form">   						 	
							<div class="row">
								<div class="col-sm-2">
									<div class="checkbox">
										<label>
											<input type="checkbox" ng-model="viewUnistalledCheck">
											<span class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
											<span translate-cloak translate title="{{'MANAGEMENT_STREAM_LIST_SHOW_UNINSTALLED_HINT'|translate}}">MANAGEMENT_STREAM_LIST_SHOW_UNINSTALLED&nbsp;</span>
										</label>
									</div>
								</div>
								<div class="col-sm-2">
									<div class="checkbox">
										<label>
											<input type="checkbox" ng-model="viewUnpublishedCheck">
											<span class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
											<span translate-cloak translate title="{{'MANAGEMENT_STREAM_LIST_SHOW_UNPUBLISHED_HINT'|translate}}">MANAGEMENT_STREAM_LIST_SHOW_UNPUBLISHED&nbsp;</span>
										</label>
									</div>
								</div>
								<div class="col-sm-2">
									<input type="text" class="form-control input-sm " ng-model="domainFilter" placeholder="{{'DATASET_LIST_DOMAIN_FILTER'|translate}}" />
								</div>
								<!-- <div class="col-sm-2">
									<input type="text" class="form-control input-sm" ng-model="typeFilter" placeholder="{{'DATASET_LIST_TYPE_FILTER'|translate}}" />
								</div> -->
								<div class="col-sm-3">
									<input type="text" class="form-control input-sm" ng-model="codeFilter" placeholder="{{'DATASET_LIST_CODE_FILTER'|translate}}" />
								</div>
								<div class="col-sm-3">
									<input type="text" class="form-control input-sm" ng-model="nameFilter" placeholder="{{'DATASET_LIST_NAME_FILTER'|translate}}" />
								</div>
							</div>
						</form>

					</div>
				</div>			

							
				<div class="table-responsive management-datasetList-table">
					<table class="table">
						<thead>
							<tr>
								<th></th>
								<th></th>
								<th>
									<a href="" ng-click="predicate  = 'datasetname'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_METADATA_NAME</span>
									<span ng-show="predicate=='datasetname' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='datasetname' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'datasetcode'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_CONFIGDATA_CODE</span>
									<span ng-show="predicate=='datasetcode' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='datasetcode' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'domain.domaincode'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_METADATA_DATADOMAIN</span> 
									<span ng-show="predicate=='domain.domaincode' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='domain.domaincode' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'datasetSubtype.datasetSubtype'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_CONFIGDATA_TYPE</span> / <span translate-cloak translate>DATASET_FIELD_CONFIGDATA_SUBTYPE</span>
									<span ng-show="predicate=='datasetSubtype.datasetSubtype' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='datasetSubtype.datasetSubtype' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'registrationdate'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_METADATA_REGISTRATIONDATE</span>
									<span ng-show="predicate=='registrationdate' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='registrationdate' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'status.statuscode|translate'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_STATUS</span> 
									<span ng-show="predicate=='status.statuscode|translate' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='status.statuscode|translate' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'version'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_CONFIGDATA_DATAVERSION</span>
									<span ng-show="predicate=='version' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='version' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
								<th>
									<a href="" ng-click="predicate = 'visibility'; reverse=!reverse"><span translate-cloak translate>DATASET_FIELD_METADATA_VISIBILITY</span>
									<span ng-show="predicate=='version' && !reverse" class="glyphicon glyphicon-chevron-up small"></span>
									<span ng-show="predicate=='version' && reverse" class="glyphicon glyphicon-chevron-down small"></span></a>
								</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-show="showLoading">
								<td colspan='10' >
									<div class='ajax-loading-container'>
										<span class='ajax-loading-big'></span>
										<h4>Loading...</h4>
									</div>
								</td>
							</tr>
							<tr ng-repeat="dataset in filteredDatasetsList = (datasetList | filter: searchNameFilter | filter: viewUnistalledFilter | filter: viewUnpublishedFilter | filter: searchDomainFilter | filter: searchCodeFilter | orderBy:predicate:reverse) |startFrom:(currentPage-1)*pageSize | limitTo:pageSize ">
								<td>
									<div class="checkbox">
										<label>
											<input type="checkbox" ng-checked="isSelected(dataset)"  ng-click="updateSelection($event, dataset)">
											<span class="cr"><i class="cr-icon glyphicon glyphicon-ok"></i></span>
										</label>
									</div>
								</td>
								<td class='text-center no-border-right'>
									<a href="#/management/viewDatasource/dataset/{{tenant}}/{{dataset.datasetcode}}/{{dataset.iddataset}}">
										<img ng-src="{{datasetIconUrl(organizationCode,dataset.iddataset)}}" alt="logo dataset" class='list-entity-icon-preview-img' >
									</a>
								</td>
								<td class='text-left no-border-left'>
									<a href="#/management/viewDatasource/dataset/{{tenant}}/{{dataset.datasetcode}}/{{dataset.iddataset}}">
										{{dataset.datasetname}}
									</a>
								</td>
								<td><a href="#/management/viewDatasource/dataset/{{tenant}}/{{dataset.datasetcode}}/{{dataset.iddataset}}">{{dataset.datasetcode}}</a></td>
								<td>
									<div class='domain-column'>
										<i ng-if='dataset.domain.domaincode!="MULTI"' class="icon-{{dataset.domain.domaincode}} domain-icon" title="{{dataset.domain.domaincode|translate}}"></i>
										<div class='domain-multi-icon'  ng-if='dataset.domain.domaincode=="MULTI"'>
											<i class='fa fa-circle-o'></i>
											<small>MULTI</small>
										</div>
									</div>
								</td>
								<td>
									<i class='glyphicon glyphicon-paperclip management-datasetList-attach-icon' ng-if="dataset.idDataSourceBinary!=null" title='Dataset with binary attachment'></i>
									<span>{{'DATASET_TYPE_'+dataset.datasetType.datasetType|translate}}</span>/
									<span>{{'DATASET_SUBTYPE_'+dataset.datasetSubtype.datasetSubtype|translate}}</span>
								</td>
								<td>{{dataset.registrationdate|dataset_date_format}}</td>
								<td class='text-left'><span class="stream-status stream-status-{{dataset.status.statuscode}}" title="{{dataset.status.statuscode|translate}}">{{dataset.status.statuscode|translate|string_ellipse:12}}</span></td>
								<td><span translate-cloak translate>{{dataset.version}}</span> <strong class='text-icon entity-uninstalled-icon' ng-if="dataset.status.idStatus==5 || dataset.status.idStatus==4" title='{{"DATASET_FIELD_CONFIGDATA_DELETED"|translate}}'>D</strong></td>
								<td><span translate-cloak translate>{{dataset.visibility}}</span> <strong class='text-icon entity-unpublished-icon' ng-if="dataset.unpublished" title='{{"DATASET_FIELD_UNPUBLISHED_TRUE"|translate}}'>NP</strong></td>
							</tr>
						</tbody>
					</table>
					<div  class='text-center'>
						<pagination boundary-links="true" total-items="filteredDatasetsList.length" ng-model="currentPage" ng-change="selectPage()" class="pagination-sm" previous-text="&lsaquo;"
							next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
						></pagination>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal -->
	<script type="text/ng-template" id="deleteDatasetUninstall.html">
		<div class='modal-header'>
        	<h3 class='modal-title'>..::{{'MANAGEMENT_DATASET_LIST_DELETE_DATASET'|translate}}::..</h3>
	    </div>
    <div id="changeQueue" class='modal-body'>
		<div class="panel panel-default">
			<span>{{'MANAGEMENT_DATASET_CONFIRM_DELETE'|translate}}</span>
    	</div>
    </div>
    	<div class="modal-footer">
        	<button class='btn btn-primary' type='button' ng-click='ok()'>OK</button>
	        <button class='btn btn-warning' type='button' ng-click='cancel()'>Cancel</button>
    	</div>
	</script>
</div>

