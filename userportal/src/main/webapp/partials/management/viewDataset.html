<div ng-controller="ManagementDatasetCtrl as datasetCtrl" ng-cloak>
	<div class='container'>
		<h3 class='entity-title'><span translate>DATASET</span>  <small>{{dataset.datasetCode}} - {{dataset.info.datasetName}}</small></h3>
		<div class='clearfix entity-info entity-info-top'>
			<div class='pull-left'>
				<div><small><span translate>DATASET_FIELD_METADATA_NAME</span></small></div>
				<div class='main-info'><strong>{{dataset.info.datasetName}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>DATASET_FIELD_METADATA_REGISTRATIONDATE</span></small></div>
				<div><strong>{{dataset.info.registrationDate|date}}</strong></div>
			
			</div>
		</div>
		<div class='clearfix entity-info entity-info-bottom'>
			<div class='pull-left'>
				<div><small><span translate>DATASET_FIELD_CONFIGDATA_CODE</span></small></div>
				<div class='url'><strong>{{dataset.datasetCode}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>DATASET_FIELD_VERSION</span></small></div>
				<div><strong>{{dataset.datasetVersion}}</strong>  <span ng-show="dataset.configData.deleted==1" translate>DATASET_FIELD_CONFIGDATA_DELETED</span></div>
			</div>
		</div>
		
		<accordion close-others="false">
			<accordion-group is-open="!status0.open">
			 	<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_DATASET_GENERAL_INFO</span>
		 			<i class="pull-right glyphicon hide" ng-class="{'glyphicon-minus': status0.open, 'glyphicon-plus': !status0.open}"></i>
				</accordion-heading>
				<div class='row'>
					<div class="col-sm-10">
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_DESCRIPTION</span></strong></div>
							<div class='col-sm-6'><span >{{dataset.info.description}}</span></div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_DATADOMAIN</span></strong></div>
							<div class='col-sm-6'><span >{{dataset.info.dataDomain|translate}}</span></div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_TAGS</span></strong></div>
							<div class='col-sm-6'>
								<ul class="list-inline">
									<li ng-repeat="tag in dataset.info.tags"><span class="label label-tag label-custom"><span ng-bind-html="tag.tagCode|translate"></span></span></li>
								</ul>
							</div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_EXTERNAL_REFERENCE</span></strong></div>
							<div class='col-sm-10'>{{dataset.info.externalReference|nvl:' -'}}</div>
						</div>	
						<div class="row card-row">
							<div class="col-sm-2 card-label"><strong><span ng-bind-html="'DATASET_FIELD_METADATA_VISIBILITY'|translate"></span></strong></div>
							<div class='col-sm-2'>{{dataset.info.visibility}}</div>
							<div class='col-sm-2 text-right'card-label" ng-show="dataset.info.visibility=='private'"><strong><span translate>DATASET_FIELD_TENANTSSHARED_WITH</span></strong></div>
							<div class='col-sm-6'>
								<span  ng-repeat="tenantSharing in dataset.info.tenantssharing.tenantsharing">
									<span ng-show="tenantSharing.isOwner==0" >{{tenantSharing.tenantName}}</span>
								</span> &nbsp;
							</div>
						</div>
					</div>
					<div class="col-sm-2 text-right">
						<img ng-src="{{dataset.info.icon}}" alt="logo dataset" class='upload-icon-preview-img' >
					</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="statusOpendata.open" ng-show="dataset.opendata.isOpendata=='true'">
			 	<accordion-heading>
		 			<span ng-bind-html="'DATASET_FIELD_METADATA_OPENDATA'|translate"></span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': statusOpendata.open.open, 'glyphicon-plus': !statusOpendata.open.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span ng-bind-html="'DATASET_FIELD_METADATA_OPENDATA_AUTHOR'|translate"></span></strong></div>
					<div class='col-sm-10'>{{dataset.opendata.author}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_OPENDATA_LANG</span></strong></div>
					<div class='col-sm-10'>{{dataset.opendata.language}} - {{dataset.opendata.language|translate}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_OPENDATA_DATA_UPDATE_DATE</span></strong></div>
					<div class='col-sm-10'>{{dataset.opendata.dataUpdateDate|date}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status1.open">
			 	<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_DATASET_LEGAL_INFO</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status1.open, 'glyphicon-plus': !status1.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_LICENSE</span></strong></div>
					<div class='col-sm-10'>{{dataset.info.license|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_DISCLAIMER</span></strong></div>
					<div class='col-sm-10'>{{dataset.info.disclaimer|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>DATASET_FIELD_METADATA_COPYRIGHT</span></strong></div>
					<div class='col-sm-10'>{{dataset.info.copyright|nvl:' -'}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status2.open" ng-show="stream!=null">
				<accordion-heading>
					<span translate>VIRTUALENTITY</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status2.open, 'glyphicon-plus': !status2.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_NAME</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.virtualEntityName|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_CODE</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.virtualEntityCode|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_DESCRIPTION</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.virtualEntityDescription|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_TYPE</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.virtualEntityType|nvl:''}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_CATEGORY</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.virtualEntityCategory|nvl:''}}</div>
				</div>	
				<div class="row card-row"  ng-show="stream.streams.stream.virtualEntityPositions.position!=null">
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_POSITION</span></strong></div>
					<div class='col-sm-4'>[{{stream.streams.stream.virtualEntityPositions.position[0].lat}};{{stream.streams.stream.virtualEntityPositions.position[0].lon}}]</div>
					<div class="col-sm-2 card-label"><strong><span translate>VIRTUALENTITY_FIELD_ELEVATION</span></strong></div>
					<div class='col-sm-4'>{{stream.streams.stream.virtualEntityPositions.position.elevation[0]|nvl:' -'}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status3.open" ng-show="stream!=null">
				<accordion-heading>
					<span translate>STREAM</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status3.open, 'glyphicon-plus': !status3.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_NAME</span></strong></div>
					<div class='col-sm-10'>{{stream.streamName|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_CODE</span></strong></div>
					<div class='col-sm-10'>{{stream.streamCode|nvl:' -'}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_FPS</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.fps|nvl:' -'}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status4.open" ng-show="stream.streams.stream.idTipoVe == VIRTUALENTITY_TYPE_TWITTER_ID && stream.streams.stream.idTipoVe!=null">
				<accordion-heading>
		 			<span translate>MANAGEMENT_EDIT_STREAM_TWITTER_DATA</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status5.open, 'glyphicon-plus': !status5.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_QUERY</span></strong></div>
					<div class='col-sm-6'>{{stream.streams.stream.twtQuery}}</div>
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_LANG</span></strong></div>
					<div class='col-sm-2'>{{stream.streams.stream.twtLang}}</div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>MANAGEMENT_NEW_STREAM_GEO_COORDINATES</span></strong></div>
					<div class='col-sm-6'><span ng-show="stream.twtGeolocLat!=0 || stream.twtGeolocLon!=0">{{stream.streams.stream.twtGeolocLat}},{{stream.streams.stream.twtGeolocLon}}</span></div>
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_GEO_RADIUS</span></strong></div>
					<div class='col-sm-2'><span ng-show="stream.twtGeolocRadius!=0">{{stream.streams.stream.twtGeolocRadius}} {{stream.streams.stream.twtUnit}}</span></div>
				</div>	
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>STREAM_FIELD_TWT_RATE</span></strong></div>
					<div class='col-sm-10'>{{stream.streams.stream.twtRatePercentage}}</div>
				</div>	
			</accordion-group>
			<accordion-group is-open="status5.open">
				<accordion-heading>
					<span translate>MANAGEMENT_EDIT_DATASET_COLUMNS</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status4.open, 'glyphicon-plus': !status4.open}"></i>
				</accordion-heading>
			
				<div class="col-sm-12">
					<table class="table">
						<thead>
							<tr>
								<th translate>DATASET_FIELD_METADATA_FIELD_NAME</th>
								<th translate>DATASET_FIELD_METADATA_FIELD_ALIAS</th>
								<th translate>DATASET_FIELD_METADATA_FIELD_DATATYPE</th>
								<th translate>DATASET_FIELD_METADATA_FIELD_SOURCE_COLUMN</th>
								<th translate>DATASET_FIELD_METADATA_FIELD_UNIT</th>
								<th translate>DATASET_FIELD_METADATA_FIELD_IS_KEY</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="field in dataset.info.fields">
								<td>{{field.fieldName}}</td>
								<td>{{field.fieldAlias}}</td>
								<td>{{field.dataType|nvl:' - '}}</td>
								<td>{{field.sourceColumn}}</td>
								<td>{{field.measureUnit|nvl:' - '}}</td>
								<td>{{field.isKey|booleanToString|translate}}</td>
								
						</tbody>
					</table>
				</div>
			</accordion-group>
			<accordion-group is-open="status6.open">
				<accordion-heading>
					<span translate>MANAGEMENT_VIEW_DATASET_DATA_URLS</span>
		 			<i class="pull-right glyphicon" ng-class="{'glyphicon-minus': status5.open, 'glyphicon-plus': !status5.open}"></i>
				</accordion-heading>
				<div class="row card-row">
					<div class="col-sm-2 card-label"><strong><span translate>MANAGEMENT_EDIT_DATASET_API_URL</span></strong></div>
					<div class='col-sm-10'><a ng-href="#/dataexplorer/dataset/{{dataset.configData.tenantCode}}/{{dataset.datasetCode}}"  translate>MANAGEMENT_VIEW_DATASET_GO_TO_DATASET_CARD</a></div>
				</div>	
			</accordion-group>
		</accordion>
		<!--  <h4><span translate>MANAGEMENT_VIEW_DATASET_DATA_URLS</span></h4>
		<strong><span translate>MANAGEMENT_EDIT_DATASET_API_URL</span></strong>
		<p><a href="{{apiMetdataUrl}}" target="_blank" class='management-dataset-download-link'>{{apiMetdataUrl}}</a></p>-->
		<div class='row'>
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<div class="row card-toolbar">
					<a  href='#/dataexplorer/{{tenant}}/{{dataset.datasetCode}}' class="btn btn-edit" >
						<span class="glyphicon glyphicon-th-large"></span> {{'MANAGEMENT_VIEW_DATASET_DATA_EXPLORER_BUTTON'|translate}}
					</a>
					<a  href ng-click='cloneDataset()' class="btn btn-edit">
						<i class="fa fa-files-o" ></i> <span translate>MANAGEMENT_VIEW_DATASET_CLONE_BUTTON</span>
					</a>
					<a  href='#/management/editDataset/{{tenant}}/{{dataset.datasetCode}}' class="btn btn-edit" ng-show="isOwner() && canEdit() && isAuthorized('management/datasets/update')">
						<span class="glyphicon glyphicon-pencil "></span> {{'MANAGEMENT_VIEW_DATASET_EDIT_BUTTON'|translate}}
					</a>
					<a  href='#/management/uploadDataset/{{tenant}}/{{dataset.datasetCode}}' class="btn  btn-new" ng-show="isOwner()  && canAddData() && isAuthorized('management/datasets/upload')">
						<span class="glyphicon glyphicon-cloud-upload "></span> {{'MANAGEMENT_VIEW_DATASET_ADD_DATA_BUTTON'|translate}}
					</a>
					<a  href='{{downloadCsvUrl}}' class="btn  btn-download-dataset" ng-show="isAuthorized('management/datasets/download')"  >
						<span class="glyphicon glyphicon-cloud-download "></span> {{'MANAGEMENT_VIEW_DATASET_DOWNLOAD_BUTTON'|translate}}
					</a>
<!-- 					<a href="javascript:void(0)" ng-click='openModalView()' class="btn btn-delete" ng-disabled="!isAuthorized('management/datasets/update') || !isOwner() || !canDelete()" title="{{'MANAGEMENT_DATASET_LIST_DELETE_DATASET_BUTTON_HINT'|translate}}">
						<span class="glyphicon glyphicon-trash "></span>&nbsp;<span translate>MANAGEMENT_DATASET_LIST_DELETE_DATA_DATASET</span>
					</a>
					 -->
				</div>
			</div>
		</div>
	</div>
	<div> <!-- ng-show="ModalDemoCtrl" -->
	    <script type="text/ng-template" id="myModalContent.html">
        <div class="modal-header">
            <h3 class="modal-title">{{'MANAGEMENT_DATASET_MODAL_DELETE_TITLE'|translate}}</h3>
            <h4 class="modal-title" ng-show="datasetModalView.dataset.todo==true">{{'MANAGEMENT_DATASET_MODAL_DELETE_SUBTITLE'|translate}}</h4>
        </div>
        <div class="modal-body" ng-show="datasetModalView.dataset.todo==true">
            <div>
                <b>{{'DATASET_FIELD_CONFIGDATA_CODE'|translate}}</b>: {{datasetModalView.dataset.datasetCode}} <br />
				<b>{{'DATASET_FIELD_CONFIGDATA_TENANT'|translate}}</b>: {{datasetModalView.dataset.configData.tenantCode}} <br />
				<b>{{'DATASET_FIELD_CONFIGDATA_TYPE'|translate}}</b>: {{datasetModalView.dataset.configData.type}} <br />
				<b>{{'DATASET_FIELD_CONFIGDATA_SUBTYPE'|translate}}</b>: {{datasetModalView.dataset.configData.subtype}} <br />
				<b>{{'DATASET_FIELD_METADATA_NAME'|translate}}</b>: {{datasetModalView.dataset.info.datasetName}}
				<b>{{'DATASET_FIELD_METADATA_DESCRIPTION'|translate}}</b>: {{datasetModalView.dataset.info.description}}
            </div>
        </div>
        <div class="modal-body" ng-show="datasetModalView.dataset.okdo==true">
            <div>{{'MANAGEMENT_DATASET_MODAL_DELETE_OKMSG'|translate}}</div>
        </div>
        <div class="modal-body" ng-show="datasetModalView.dataset.kodo==true">
            <div>{{'MANAGEMENT_DATASET_MODAL_DELETE_KOMSG'|translate}}</div>
        </div>
        <div class="modal-footer" ng-show="datasetModalView.dataset.todo==true">
            <button class="btn btn-primary" type="button" ng-click="deleteDataset()">SI</button>
            <button class="btn btn-warning" type="button" ng-click="cancel()">NO</button>
        </div>
        <div class="modal-footer" ng-show="datasetModalView.dataset.okdo==true">
			<!-- bottoni distinti anche se apparentemente uguali per manutenzione -->
            <button class="btn btn-primary" type="button" ng-click="cancel()">chiudi</button>
        </div>
        <div class="modal-footer" ng-show="datasetModalView.dataset.kodo==true">
			<!-- bottoni distinti anche se apparentemente uguali per manutenzione -->
            <button class="btn btn-primary" type="button" ng-click="cancel()">chiudi</button>
        </div>
    	</script>
	</div>
</div>
