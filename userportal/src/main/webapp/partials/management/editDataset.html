<div ng-controller="ManagementDatasetCtrl as datasetCtrl">
	<div class='container'>
		<h3 class='content-edit-title'><span translate>DATASET</span> <small><span translate>MANAGEMENT_EDIT_DATASET_SUBTITLE</span>  {{dataset.datasetCode}} - {{dataset.info.datasetName}}</small></h3>
		<div class='clearfix entity-info entity-info-top'>
			<div class='pull-left'>
				<div><small><span translate>DATASET_FIELD_METADATA_NAME</span></small></div>
				<div class='main-info'><strong>{{dataset.info.datasetName}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>DATASET_FIELD_METADATA_REGISTRATIONDATE</span></small></div>
				<div><strong>{{dataset.info.registrationDate|date}}</strong></div>
			
			</div>
		</div>
		<div class='clearfix entity-info entity-info-bottom'>
			<div class='pull-left'>
				<div><small><span translate>DATASET_FIELD_CONFIGDATA_CODE</span></small></div>
				<div class='url'><strong>{{dataset.datasetCode}}</strong></div>
			</div>
			<div class='pull-right text-right'>
				<div><small><span translate>DATASET_FIELD_VERSION</span></small></div>
				<div><strong>{{dataset.datasetVersion}}</strong></div>
			
			</div>
		</div>
	</div>
	<div class='content-gray'>
		<div class='container'>
			<p>&nbsp;</p>
			<div class='row'>
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="alert alert-danger" ng-show='updateError'>
						<div class='row  text-left' ng-repeat="error in updateErrors">
							<div class="col-lg-4 col-md-6 col-sm-12 col-xs-12">{{error.message|string_ellipse:50}}</div>
							<div class="col-lg-8 col-md-1 col-sm-12 col-xs-12">{{error.detail|string_ellipse:120}}</div>
						</div>		
					</div>
					<div class="alert alert-success" ng-show='updateInfo'>
						<strong translate>MANAGEMENT_EDIT_DATASET_DATA_SAVED_INFO</strong> {{updateInfo.status}}
					</div>
				</div>
			</div>
			<div class='row'>
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
		
					<form class="form-horizontal" role="form" name="editDatasetForm">
						<div class="form-group">
							<label for="inputDatasetDesc" class="col-sm-2 control-label" translate>DATASET_FIELD_METADATA_DESCRIPTION</label>
							<div class="col-sm-10">
								<input type="text" class="form-control" ng-model="dataset.info.description"  id="inputDatasetDesc" placeholder="{{'DATASET_FIELD_METADATA_DESCRIPTION'|translate}}" >
							</div>
						</div>
						<div class="form-group">
							<label for="inputDatasetDomain" class="col-sm-2 control-label"translate>DATASET_FIELD_METADATA_DATADOMAIN</label>
							<div class="col-sm-10">
								<select class="input-sm form-control" ng-model="dataset.info.dataDomain" ng-options="domain as (domain|translate) for domain in domainList">
			    					<option value="" translate>MANAGEMENT_EDIT_DATASET_DOMAIN_PLACEHOLDER</option>
			    				</select>
							</div>
						</div>		
						<div class="form-group">
							<label for="inputDatasetAddTag" class="col-sm-2 control-label" translate>DATASET_FIELD_METADATA_TAGS</label>
							<div class="col-sm-10">
								<p>
									<span  ng-repeat="tag in dataset.info.tags">
										<span class="label label-tag label-custom"><span ng-bind-html="tag.tagCode|translate"></span> &nbsp;
										<a href="javascript:void(0)" ng-click='removeTag($index)'>&times;</a>
										</span> &nbsp;
									</span>
								</p>						
								<p>
									<div class="input-group">
			    						<select class="input-sm form-control" ng-model="newTag" ng-options="tag as (tag|translate) for tag in tagList">
			    							<option value="" ng-bind-html="'MANAGEMENT_EDIT_DATASET_TAG_PLACEHOLDER'|translate" ></option>
			    						</select>
									    <span class="input-group-btn">
									    	<a class="btn  btn-sm btn-add"  href="javascript:void(0)" ng-click='addTag()' title="{{'MANAGEMENT_EDIT_DATASET_ADD_TAG'|translate}}" >
									    		<i class='glyphicon glyphicon-plus'></i>
									    	</a>
									    </span>
			    					</div>
								</p>
							</div>
						</div>			
						<div class="form-group">
							<label for="RadioGroupVisibility" class="col-sm-2 control-label"><span ng-bind-html="'DATASET_FIELD_METADATA_VISIBILITY'|translate"></span></label>
							<div class="col-sm-10">
								<label class="radio-inline">
			              			<input type="radio" name="RadioGroupVisibility" value="public" id="RadioGroupVisibility_0" ng-model="dataset.info.visibility">
			              			<span translate>MANAGEMENT_EDIT_DATASET_VISIBILITY_PUBLIC</span>
			            		</label>
								<label class="radio-inline">
			              			<input type="radio" name="RadioGroupVisibility" value="private" id="RadioGroupVisibility_1" ng-model="dataset.info.visibility">
			              			<span translate>MANAGEMENT_EDIT_DATASET_VISIBILITY_PRIVATE</span>
			            		</label>
							</div>
						</div>
						<div class="form-group">
							<label for="inputDatasetIcon" class="col-sm-2 control-label"><span translate>STREAM_FIELD_ICON</span></label>
							<div class="col-sm-3">
								<div ng-file-drop="onIconSelect($files)" class='upload-icon-drop-area' ng-file-drag-over-class="upload-icon-drop-area-hover" ng-show="dropSupported">
									<div translate>MANAGEMENT_EDIT_DATASET_UPLOAD_ICON_DROPAREA</div>
									<div class='desc'>256x256</div>
									<div class='desc'>jpg | png</div>
								</div>
								<div ng-file-drop-available="dropSupported=true" ng-show="!dropSupported">HTML5 Drop File is not supported!</div>
							</div>
							<div class="col-sm-2">
								<div class='upload-icon-label-before-button'><span translate>MANAGEMENT_EDIT_STREAM_UPLOAD_ICON_OR</span></div>
								<div ng-file-select="onIconSelect($files)" data-multiple="true" title="select file" onclick="this.value = null" class="upload-icon-selecticon-button">
									<span translate>MANAGEMENT_EDIT_STREAM_UPLOAD_ICON_BUTTON_LOAD_FILE</span>
								</div>
							</div>
							<div class="col-sm-3 col-sm-offset-2 text-right">
								<img src="{{dataset.info.icon}}" alt="logo dataset" class='upload-icon-preview-img' >
							</div>
							
						</div>			
						
						<div class='form-label-separator' translate>MANAGEMENT_EDIT_DATASET_LEGAL_INFO</div>
						<div class="form-group">
							<label for="v" class="col-sm-2 control-label" translate>DATASET_FIELD_METADATA_LICENSE</label>
							<div class="col-sm-10">
								<input type="text" class="form-control" id="inputDatasetLicence" placeholder="{{'DATASET_FIELD_METADATA_LICENSE'|translate}}" ng-model="dataset.info.license" >
							</div>
						</div>			
						<div class="form-group">
							<label for="inputDatasetDisclaimer" class="col-sm-2 control-label" translate>DATASET_FIELD_METADATA_DISCLAIMER</label>
							<div class="col-sm-10">
								<textarea class="form-control" rows="4" resize="none" ng-model="dataset.info.disclaimer"  placeholder="{{'DATASET_FIELD_METADATA_DISCLAIMER'|translate}}" id="inputDatasetDisclaimer" >
								</textarea>					
							</div>
						</div>			
						<div class="form-group">
							<label for="inputDatasetCopyright" class="col-sm-2 control-label" translate>DATASET_FIELD_METADATA_COPYRIGHT</label>
							<div class="col-sm-10">
								<input type="text" class="form-control" id="inputDatasetCopyright" placeholder="{{'DATASET_FIELD_METADATA_COPYRIGHT'|translate}}" ng-model="dataset.info.copyright" >
							</div>
						</div>							
						<div class='form-label-separator' translate>MANAGEMENT_EDIT_DATASET_COLUMNS</div>
						<div class="col-sm-12"><span ng-bind-html="MANAGEMENT_EDIT_DATASET_COLUMNS_HELP|translate"></span></div>
						<div class="col-sm-10 col-sm-offset-1">
							<table class="table">
								<thead>
									<tr>
										<th translate>DATASET_FIELD_METADATA_FIELD_NAME</th>
										<th translate>DATASET_FIELD_METADATA_FIELD_ALIAS</th>
										<th translate>DATASET_FIELD_METADATA_FIELD_DATATYPE</th>
										<th translate>DATASET_FIELD_METADATA_FIELD_SOURCE_COLUMN</th>
										<th translate>DATASET_FIELD_METADATA_FIELD_UNIT</th>
										<th translate>DATASET_FIELD_METADATA_FIELD_IS_KEY</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat="field in dataset.info.fields">
										<td>{{field.fieldName}}</td>
										<td><input class="input-sm form-control" type="text" name="fieldAlias"ng-model="field.fieldAlias" ></td>
										<td>{{field.dataType|nvl:' - '}}</td>
										<td>{{field.sourceColumn}}</td>
										<td>{{field.measureUnit|nvl:' - '}}</td>
										<td>{{field.isKey|booleanToString|translate}}</td>
										
								</tbody>
							</table>
						</div>
						<div class="row">
							<div class=" col-sm-12 form-toolbar" ng-show="isAuthorized('management/datasets/update') ">
								<a  href='#/management/viewDataset/{{tenant}}/{{datasetCode}}' class="btn" translate>MANAGEMENT_EDIT_DATASET_FINISH_BUTTON</a>
								<a  ng-click='updateDataset()'  class="btn btn-default" ng-disabled="!isOwner() || editDatasetForm.$invalid" translate>MANAGEMENT_EDIT_DATASET_SAVE_BUTTON</a>
		
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
